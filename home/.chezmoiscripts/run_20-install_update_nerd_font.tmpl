#!/usr/bin/env bash

FONT={{ .nerdFont | quote }}
REPO="https://github.com/ryanoasis/nerd-fonts"
DEST=~/.local/share/fonts

# Clean up existing font
rm -fr $DEST/$FONT

# Get latest release version
LOCATION=$(curl -si $REPO/releases/latest | grep -i 'location:*')
REGEX='releases/tag/(v[0-9\.]+)'

[[ $LOCATION =~ $REGEX ]]

TAG=${BASH_REMATCH[1]}

echo "Installing Nerd Font: $FONT $TAG"

curl --create-dirs --progress-bar -Lo $DEST/$FONT.tar.xz $REPO/releases/download/$TAG/$FONT.tar.xz
cd $DEST && mkdir $FONT && tar -xvJf $FONT.tar.xz -C $FONT && rm $FONT.tar.xz
fc-cache -fv
