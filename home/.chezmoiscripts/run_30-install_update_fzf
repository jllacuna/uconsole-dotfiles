#!/usr/bin/env bash

DEST=~/.local/share/fzf

if [ -d $DEST ]; then
  cd $DEST && git fetch
  if [[ $(git rev-parse '@') == $(git rev-parse '@{u}') ]]; then
    FZF_VERSION=$(fzf --version 2> /dev/null)
    VERSION_REGEX='[0-9\.]+'

    [[ $FZF_VERSION =~ $VERSION_REGEX ]]
    CURRENT_TAG=${BASH_REMATCH[0]}

    echo "fzf is up-to-date: v$CURRENT_TAG"
    exit 0
  else
    echo 'Updating fzf'
    git merge
  fi
else
  echo "Installing fzf"
  git clone --depth 1 https://github.com/junegunn/fzf.git $DEST
fi

$DEST/install --xdg --key-bindings --completion --no-update-rc
